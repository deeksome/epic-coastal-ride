<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Epic Coastal Ride 2025</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#764ba2" />
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("sw.js")
        .then(() => console.log("Service Worker registered"));
    }
  </script>
  <style>
    #map { height: 400px; }
  </style>
</head>
<body class="itinerary-page">
  <div class="brochure">
    <!-- LEFT PANEL -->
    <div class="panel-left">
      <div class="panel-left-content">
        <div class="decorative-circle circle-1"></div>
        <div class="decorative-circle circle-2"></div>
        <div class="decorative-circle circle-3"></div>

        <h1>EPIC<br>COASTAL<br>RIDE 2025</h1>

        <div class="bike-icon">ğŸï¸</div>

        <div class="ride-info is-expanded" data-section-key="details">
          <div class="ride-info-header">
            <h3>RIDE DETAILS</h3>
            <button class="section-toggle" type="button" aria-expanded="true" aria-controls="ride-details-body" aria-label="Collapse ride details" data-section-label="ride details">
              <span class="arrow"></span>
            </button>
          </div>
          <div class="ride-info-body" id="ride-details-body">
            <p><strong>ğŸ“… Duration:</strong> 12 Days</p>
            <p><strong>ğŸ“ Start:</strong> Bangalore</p>
            <p><strong>ğŸ End:</strong> Bangalore</p>
            <p><strong>ğŸ—“ï¸ Dates:</strong> Dec 20-31, 2025</p>
          </div>
        </div>

        <div class="ride-info is-expanded map-card" data-section-key="map">
          <div class="ride-info-header">
            <h3>ROUTE MAP</h3>
            <button class="section-toggle" type="button" aria-expanded="true" aria-controls="ride-map-body" aria-label="Collapse route map" data-section-label="route map">
              <span class="arrow"></span>
            </button>
          </div>
          <div class="ride-info-body" id="ride-map-body">
            <a class="map-link" href="https://www.google.com/maps/dir/?api=1&amp;origin=Bangalore&amp;destination=Bangalore&amp;travelmode=driving&amp;waypoints=Benaulim+Beach%7CMurudeshwara%7CKannur%7CKochi%7CKanyakumari%7CRameshwaram%7CKodiyakarai%7CPondicherry%7CChennai" target="_blank" rel="noopener">
              <div id="map"></div>
            </a>
            <p class="map-note">Tap the map to open the full itinerary in your maps app.</p>
          </div>
          <script>
            const map = L.map('map').setView([11.5, 75.5], 6);
            window.epicRideMap = map;
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
              attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);
            
            const locations = [
              {name: 'Bangalore', coords: [12.9716, 77.5946]},
              {name: 'Benaulim Beach', coords: [15.2490, 73.9272]},
              {name: 'Murudeshwara', coords: [14.0922, 74.4845]},
              {name: 'Kannur', coords: [11.8745, 75.3704]},
              {name: 'Kochi', coords: [9.9312, 76.2673]},
              {name: 'Kanyakumari', coords: [8.0883, 77.5385]},
              {name: 'Rameshwaram', coords: [9.2880, 79.3129]},
              {name: 'Kodiyakarai', coords: [10.3760, 79.8530]},
              {name: 'Pondicherry', coords: [11.9139, 79.8145]},
              {name: 'Chennai', coords: [13.0827, 80.2707]}
            ];
            
            locations.forEach(loc => {
              L.marker(loc.coords)
                .addTo(map)
                .bindPopup(loc.name);
            });
          </script>
        </div>

        <div class="ride-info is-expanded" data-section-key="expectations">
          <div class="ride-info-header">
            <h3>WHAT TO EXPECT</h3>
            <button class="section-toggle" type="button" aria-expanded="true" aria-controls="ride-expect-body" aria-label="Collapse what to expect" data-section-label="what to expect">
              <span class="arrow"></span>
            </button>
          </div>
          <div class="ride-info-body" id="ride-expect-body">
            <p>Experience the breathtaking coastal beauty of South India on this unforgettable motorbike adventure!</p>
          </div>
        </div>
      </div>
    </div>

    <!-- MIDDLE PANEL -->
    <div class="panel-middle">
      <h2>ğŸ—ºï¸ RIDE ITINERARY</h2>
            
      <div class="day-card">
        <div class="day-image-container">
          <img src="https://images.unsplash.com/photo-1512343879784-a960bf40e7f2?w=800&h=400&fit=crop" alt="Benaulim Beach Goa" class="day-image">
          <div class="image-overlay">Benaulim Beach, Goa</div>
        </div>
        <div class="day-content">
          <span class="day-number">DAY 1 - Dec 20</span>
          <div class="route">Bangalore <span class="route-arrow">â†’</span> Benaulim Beach</div>
          <div class="details">
            <div class="detail-item">â° Start: 5:00 AM</div>
            <div class="detail-item">ğŸ“ 598 km</div>
          </div>
          <div class="attractions">
            <h4>ğŸ¯ Places to Visit En Route:</h4>
            <ul>
              <li>Chitradurga Fort (45 min stop)</li>
              <li>Anmod Ghats scenic views</li>
              <li>Dudhsagar Falls (16 km detour)</li>
            </ul>
          </div>
          <a href="galleries/day1.html" class="gallery-link">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
            </svg>
            View Gallery
          </a>
        </div>
      </div>


      </style>

      <div class="day-card">
        <div class="day-image-container">
          <img src="https://images.unsplash.com/photo-1576487248805-cf45f6bcc67f?w=800&h=400&fit=crop" alt="Murudeshwara Temple" class="day-image">
          <div class="image-overlay">Murudeshwara Temple</div>
        </div>
        <div class="day-content">
          <span class="day-number">DAY 2 - Dec 21</span>
          <div class="route">Benaulim <span class="route-arrow">â†’</span> Murudeshwara</div>
          <div class="details">
            <div class="detail-item">â° Start: 3:00 PM</div>
            <div class="detail-item">ğŸ“ 178 km</div>
          </div>
          <div class="attractions">
            <h4>ğŸ¯ Places to Visit:</h4>
            <ul>
              <li>Gokarna beaches (Om Beach)</li>
              <li>Murudeshwara Temple</li>
              <li>INS Chapal Warship Museum, Karwar</li>
              <li>Mirjan Fort</li>
            </ul>
            <a href="galleries/day2.html" class="gallery-link">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
              View Gallery
            </a>
          </div>
        </div>
      </div>

      <div class="day-card">
        <div class="day-image-container">
          <img src="https://images.unsplash.com/photo-1516483638261-f4dbaf036963?w=800&h=400&fit=crop" alt="Kannur Beach" class="day-image">
          <div class="image-overlay">Kannur Beaches</div>
        </div>
        <div class="day-content">
          <span class="day-number">DAY 3 - Dec 22</span>
          <div class="route">Murudeshwara <span class="route-arrow">â†’</span> Kannur</div>
          <div class="details">
            <div class="detail-item">â° Start: 6:00 AM</div>
            <div class="detail-item">ğŸ“ 298 km</div>
          </div>
          <div class="attractions">
            <h4>ğŸ¯ Places to Visit:</h4>
            <ul>
              <li>Netrani Island (scuba diving)</li>
              <li>Idagunji Ganapati Temple</li>
              <li>Mangalore beaches</li>
            </ul>
            <a href="galleries/day3.html" class="gallery-link">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
              View Gallery
            </a>
          </div>
        </div>
      </div>

      <div class="rest-day">
        <h3>â˜€ï¸ REST DAY</h3>
        <p><strong>Day 4 - Dec 23</strong></p>
        <p>Relax at Kannur! Visit Payyambalam Beach, St. Angelo Fort, Muzhappilangad Drive-in Beach</p>
        <a href="galleries/day4.html" class="gallery-link">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
          View Gallery
        </a>
      </div>

      <div class="day-card">
        <div class="day-image-container">
          <img src="https://images.unsplash.com/photo-1593181629936-11c609b8db9b?w=800&h=400&fit=crop" alt="Kochi Backwaters" class="day-image">
          <div class="image-overlay">Kochi Backwaters</div>
        </div>
        <div class="day-content">
          <span class="day-number">DAY 5 - Dec 24</span>
          <div class="route">Kannur <span class="route-arrow">â†’</span> Kochi</div>
          <div class="details">
            <div class="detail-item">â° Start: 6:00 AM</div>
            <div class="detail-item">ğŸ“ 292 km</div>
          </div>
          <div class="attractions">
            <h4>ğŸ¯ Places to Visit:</h4>
            <ul>
              <li>Bekal Fort</li>
              <li>Chinese Fishing Nets</li>
              <li>Fort Kochi & Mattancherry</li>
              <li>Dutch Palace</li>
            </ul>
            <a href="galleries/day5.html" class="gallery-link">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
              View Gallery
            </a>
          </div>
        </div>
      </div>

      <div class="day-card">
        <div class="day-image-container">
          <img src="https://images.unsplash.com/photo-1512343879784-a960bf40e7f2?w=800&h=400&fit=crop" alt="Kanyakumari Sunset" class="day-image">
          <div class="image-overlay">Kanyakumari Sunset Point</div>
        </div>
        <div class="day-content">
          <span class="day-number">DAY 6 - Dec 25</span>
          <div class="route">Kochi <span class="route-arrow">â†’</span> Kanyakumari</div>
          <div class="details">
            <div class="detail-item">â° Start: 6:00 AM</div>
            <div class="detail-item">ğŸ“ 305 km</div>
          </div>
          <div class="attractions">
            <h4>ğŸ¯ Places to Visit:</h4>
            <ul>
              <li>Alleppey Backwaters</li>
              <li>Varkala Beach & Cliffs</li>
              <li>Thiruvananthapuram (Padmanabhaswamy Temple)</li>
            </ul>
            <a href="galleries/day6.html" class="gallery-link">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
              View Gallery
            </a>
          </div>
        </div>
      </div>

      <div class="day-card">
        <div class="day-image-container">
          <img src="https://images.unsplash.com/photo-1537944434965-cf4679d1a598?w=800&h=400&fit=crop" alt="Rameshwaram Temple" class="day-image">
          <div class="image-overlay">Rameshwaram Temple</div>
        </div>
        <div class="day-content">
          <span class="day-number">DAY 7 - Dec 26</span>
          <div class="route">Kanyakumari <span class="route-arrow">â†’</span> Rameshwaram</div>
          <div class="details">
            <div class="detail-item">â° Start: 6:00 AM</div>
            <div class="detail-item">ğŸ“ 315 km</div>
          </div>
          <div class="attractions">
            <h4>ğŸ¯ Places to Visit:</h4>
            <ul>
              <li>Vivekananda Rock Memorial</li>
              <li>Thiruvalluvar Statue</li>
              <li>Sunrise at tip of India</li>
              <li>Pamban Bridge</li>
            </ul>
            <a href="galleries/day7.html" class="gallery-link">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
              View Gallery
            </a>
          </div>
        </div>
      </div>

      <div class="rest-day">
        <h3>â˜€ï¸ REST DAY</h3>
        <p><strong>Day 8 - Dec 27</strong></p>
        <p>Explore Rameshwaram! Visit Rameshwaram Temple, Dhanushkodi Beach, APJ Abdul Kalam Memorial</p>
        <a href="galleries/day8.html" class="gallery-link">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
          View Gallery
        </a>
      </div>

      <div class="day-card">
        <div class="day-image-container">
          <img src="https://images.pexels.com/photos/240040/pexels-photo-240040.jpeg?auto=compress&cs=tinysrgb&w=900" alt="Point Calimere Coastline" class="day-image">
          <div class="image-overlay">Kodiyakarai Coast</div>
        </div>
        <div class="day-content">
          <span class="day-number">DAY 9 - Dec 28</span>
          <div class="route">Rameshwaram <span class="route-arrow">â†’</span> Kodiyakarai</div>
          <div class="details">
            <div class="detail-item">â° Start: 6:00 AM</div>
            <div class="detail-item">ğŸ“ 254 km</div>
          </div>
          <div class="attractions">
            <h4>ğŸ¯ Places to Visit:</h4>
            <ul>
              <li>Point Calimere Wildlife Sanctuary</li>
              <li>Vedaranyam Beach</li>
              <li>Coastal fishing villages</li>
            </ul>
            <a href="galleries/day9.html" class="gallery-link">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
              View Gallery
            </a>
          </div>
        </div>
      </div>

      <div class="day-card">
        <div class="day-image-container">
          <img src="https://images.pexels.com/photos/5339233/pexels-photo-5339233.jpeg?auto=compress&cs=tinysrgb&w=900" alt="Pondicherry Promenade" class="day-image">
          <div class="image-overlay">Pondicherry Promenade</div>
        </div>
        <div class="day-content">
          <span class="day-number">DAY 10 - Dec 29</span>
          <div class="route">Kodiyakarai <span class="route-arrow">â†’</span> Pondicherry</div>
          <div class="details">
            <div class="detail-item">â° Start: 6:00 AM</div>
            <div class="detail-item">ğŸ“ 208 km</div>
          </div>
          <div class="attractions">
            <h4>ğŸ¯ Places to Visit:</h4>
            <ul>
              <li>Chidambaram Nataraja Temple</li>
              <li>French Quarter</li>
              <li>Auroville</li>
              <li>Paradise Beach</li>
            </ul>
            <a href="galleries/day10.html" class="gallery-link">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
              View Gallery
            </a>
          </div>
        </div>
      </div>

      <div class="day-card">
        <div class="day-image-container">
          <img src="https://images.unsplash.com/photo-1580136579312-94651dfd596d?w=800&h=400&fit=crop" alt="Chennai Marina Beach" class="day-image">
          <div class="image-overlay">Chennai Marina Beach</div>
        </div>
        <div class="day-content">
          <span class="day-number">DAY 11 - Dec 30</span>
          <div class="route">Pondicherry <span class="route-arrow">â†’</span> Chennai</div>
          <div class="details">
            <div class="detail-item">â° Start: 6:00 AM</div>
            <div class="detail-item">ğŸ“ 167 km</div>
          </div>
          <div class="attractions">
            <h4>ğŸ¯ Places to Visit:</h4>
            <ul>
              <li>Mahabalipuram Shore Temple</li>
              <li>Crocodile Bank</li>
              <li>Marina Beach</li>
              <li>Kapaleeshwarar Temple</li>
            </ul>
            <a href="galleries/day11.html" class="gallery-link">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
              View Gallery
            </a>
          </div>
        </div>
      </div>

      <div class="day-card">
        <div class="day-image-container">
          <img src="https://images.unsplash.com/photo-1596176530529-78163a4f7af2?w=800&h=400&fit=crop" alt="Bangalore" class="day-image">
          <div class="image-overlay">Back to Bangalore</div>
        </div>
        <div class="day-content">
          <span class="day-number">DAY 12 - Dec 31</span>
          <div class="route">Chennai <span class="route-arrow">â†’</span> Bangalore</div>
          <div class="details">
            <div class="detail-item">â° Start: 6:00 AM</div>
            <div class="detail-item">ğŸ“ 329 km</div>
          </div>
          <div class="attractions">
            <h4>ğŸ¯ Places to Visit:</h4>
            <ul>
              <li>Kanchipuram Temples</li>
              <li>Vellore Fort</li>
              <li>Hosur</li>
            </ul>
            <a href="galleries/day12.html" class="gallery-link">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
              View Gallery
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- RIGHT PANEL -->
    <div class="panel-right">
      <h2>âœ¨ HIGHLIGHTS</h2>

      <div class="stats">
        <div class="stat-box">
          <span class="stat-number">3,144</span>
          <span>Total KM</span>
        </div>
        <div class="stat-box">
          <span class="stat-number">12</span>
          <span>Days</span>
        </div>
        <div class="stat-box">
          <span class="stat-number">10</span>
          <span>Destinations</span>
        </div>
        <div class="stat-box">
          <span class="stat-number">40+</span>
          <span>Attractions</span>
        </div>
      </div>

      <div class="highlight-box">
        <h3>ğŸŒŠ Experience</h3>
        <ul>
          <li>Pristine beaches of Goa</li>
          <li>Temple town of Murudeshwara</li>
          <li>Historic Kochi backwaters</li>
          <li>Sunrise at Kanyakumari</li>
          <li>Sacred Rameshwaram</li>
          <li>French colonial Pondicherry</li>
          <li>Vibrant Chennai culture</li>
          <li>Ancient temples & forts</li>
        </ul>
      </div>

      <div class="highlight-box">
        <h3>ğŸ¯ What's Included</h3>
        <ul>
          <li>Detailed route planning</li>
          <li>40+ tourist attractions</li>
          <li>Group coordination</li>
          <li>Scenic coastal highways</li>
          <li>Cultural experiences</li>
          <li>Adventure activities</li>
        </ul>
      </div>

      <div class="contact">
        <h3>ğŸ“ JOIN THE RIDE!</h3>
        <p>Contact <em>9738003900</em> for more details</p>
        <p style="margin-top: 15px; font-size: 1.2em;"><strong>Let's ride together! ğŸï¸ğŸ’¨</strong></p>
      </div>
    </div>
  </div>
  <script>
    (function() {
      const breakpoint = 640;
      const panelLeft = document.querySelector('.panel-left');

      if (!panelLeft) {
        return;
      }

      const sections = Array.from(panelLeft.querySelectorAll('.ride-info'));
      const mapSection = panelLeft.querySelector('[data-section-key="map"]');

      const refreshMap = () => {
        if (!window.epicRideMap) return;
        requestAnimationFrame(() => {
          window.epicRideMap.invalidateSize();
        });
      };

      const updateToggleState = (section, expanded) => {
        const toggle = section.querySelector('.section-toggle');
        if (!toggle) return;
        const label = toggle.dataset.sectionLabel || 'section';
        toggle.setAttribute('aria-expanded', expanded.toString());
        toggle.setAttribute('aria-label', `${expanded ? 'Collapse' : 'Expand'} ${label}`);
        if (expanded) {
          toggle.classList.add('is-expanded');
        } else {
          toggle.classList.remove('is-expanded');
        }
      };

      const setExpanded = (section, expanded, { userInitiated = false } = {}) => {
        section.classList.toggle('is-expanded', expanded);
        updateToggleState(section, expanded);

        if (userInitiated) {
          section.dataset.userState = expanded ? 'expanded' : 'collapsed';
        }

        if (section === mapSection && expanded) {
          refreshMap();
        }
      };

      const toggleSection = (section) => {
        const expanded = section.classList.contains('is-expanded');
        setExpanded(section, !expanded, { userInitiated: true });
      };

      sections.forEach((section) => {
        const header = section.querySelector('.ride-info-header');
        if (!header) return;

        const heading = header.querySelector('h3');
        const toggle = header.querySelector('.section-toggle');

        const attachToggleHandler = (element) => {
          if (!element) return;
          element.addEventListener('click', () => toggleSection(section));
          element.addEventListener('keydown', (event) => {
            if (event.key === 'Enter' || event.key === ' ') {
              event.preventDefault();
              toggleSection(section);
            }
          });
          element.setAttribute('tabindex', '0');
        };

        attachToggleHandler(heading);
        if (toggle) {
          toggle.dataset.sectionLabel = toggle.dataset.sectionLabel || heading?.textContent?.trim().toLowerCase() || 'section';
          attachToggleHandler(toggle);
        }
      });

      const applyStateForViewport = () => {
        const isMobile = window.innerWidth <= breakpoint;

        sections.forEach((section) => {
          const userState = section.dataset.userState;

          if (!isMobile) {
            setExpanded(section, true);
            delete section.dataset.userState;
            return;
          }

          if (userState === 'expanded') {
            setExpanded(section, true);
          } else if (userState === 'collapsed') {
            setExpanded(section, false);
          } else {
            setExpanded(section, false);
          }
        });
      };

      window.addEventListener('resize', applyStateForViewport);
      applyStateForViewport();
    })();
  </script>
</body>
</html>
